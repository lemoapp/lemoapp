<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/dashboard.css">
    <meta name="theme-color" content="  #49af00">
    <meta name="apple-mobile-web-app-status-bar-style" content="  #49af00">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Lemoapp</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Jacquarda+Bastarda+9&family=Poppins:ital,wght@0,400;1,300;1,400&display=swap" rel="stylesheet">
</head>
<body>
    <div class="body-container">
        <div class="container">
            <nav>
                <button><img src="./css/images/menu button.png" alt=""></button>
                <div class="logo"><img src="css/images/lemo logo.png" alt=""></div>
                <div class="nav-items"><img src="css/images/Alarm.png" alt=""></div>
            </nav>
    
    
            <div class="space">
    
            </div>
    
    
            <div class="container1">
                <div class="top">
                    <p>
                        Total Balance
                    </p>
                    <div class="balance">
                        <p  id="balance">$ 0.00</p>
                        <button id="depositButton">+</button>
                    </div><br>
                    <hr style="border-color: #e2effa;">
                </div>
                <div class="bottom">
                    <div class="withdraw">
                        <button style="background-color: rgb(243, 64, 91);"><<</button>
                        <label>withdraw</label>
                    </div>
                    <div class="withdraw">
                        <button>>></button>
                        <label style="margin-left: 12px;">Send</label>
                    </div>
                    <div class="withdraw">
                        <button style="background-color: rgb(29, 213, 127);">C</button>
                        <label style="margin-left: 10px;">Cards</label>
                    </div>
                    <div class="withdraw">
                        <button style="background-color: rgb(243, 186, 64);">E</button>
                        <label>Exchange</label>
                    </div>
                </div><br>
            </div>
        </div>
        <section class="second"><br><br><br><br><br><br>
              <div class="entries">
                <div class="tabs1">
                    <div class="tab">
                        <p>Income</p>
                        <div class="amount"  id="income" style="color: rgb(29, 213, 127)">
                            $ 0.00
                        </div>
                    </div>
                    <div class="tab">
                        <p>Expenses</p>
                        <div class="amount" id="expenses" style="color: rgb(243, 64, 91);">
                            $ 0.00
                        </div>
                    </div>
                </div>
                <div class="tabs1">
                    <div class="tab">
                        <p>Total Bills</p>
                        <div class="amount"  id="totalBills">
                            $ 0.00
                        </div>
                    </div>
                    <div class="tab">
                        <p>Savings</p>
                        <div class="amount" id="savings">
                            $ 0.00
                        </div>
                    </div>
                </div>
              </div>

              <div class="slideshow-container">
                <!-- Slides -->
                <div class="mySlides fade">
                    <img src="./css/images/card1.png" alt="Item 1">
                </div>
                <div class="mySlides fade">
                    <img src="./css/images/card2.png" alt="Item 2">
                </div>
                <div class="mySlides fade">
                    <img src="./css/images/card3.png" alt="Item 3">
                </div>
                <div class="mySlides fade">
                    <img src="./css/images/card4.png" alt="Item 4">
                </div>
        
                <!-- Indicators/Dots -->
                <div class="dots-container">
                    <span class="dot" onclick="currentSlide(1)"></span> 
                    <span class="dot" onclick="currentSlide(2)"></span> 
                    <span class="dot" onclick="currentSlide(3)"></span> 
                    <span class="dot" onclick="currentSlide(4)"></span> 
                </div>
            </div>

              <div class="container2">
                <div class="top">
                    <h3>Transactions</h3>
                    <a href="">View all</a>
                </div>

                <div class="transactions">
                    <div class="transaction">
                        <div class="left">
                            <img src="css/images/Checkmark.png" alt="">
                            <div class="details">
                                <h4>Transfer</h4>
                                <p>Registered</p>
                            </div>
                        </div>
                        <div class="right">
                            <p>
                               + $ 50.34
                            </p>
                            <h5>
                                12th November
                            </h5>
                        </div>
                    </div>
                    <div class="transaction">
                        <div class="left">
                            <img src="css/images/Checkmark.png" alt="">
                            <div class="details">
                                <h4>Transfer</h4>
                                <p>Registered</p>
                            </div>
                        </div>
                        <div class="right">
                            <p>
                               + $ 50.34
                            </p>
                            <h5>
                                12th November
                            </h5>
                        </div>
                    </div>
                    <div class="transaction">
                        <div class="left">
                            <img src="css/images/Checkmark.png" alt="">
                            <div class="details">
                                <h4>Transfer</h4>
                                <p>Registered</p>
                            </div>
                        </div>
                        <div class="right">
                            <p>
                               + $ 120.34
                            </p>
                            <h5>
                                10th November
                            </h5>
                        </div>
                    </div>
                    <div class="transaction">
                        <div class="left">
                            <img src="css/images/Checkmark.png" alt="">
                            <div class="details">
                                <h4>Transfer</h4>
                                <p>Registered</p>
                            </div>
                        </div>
                        <div class="right">
                            <p>
                               + $ 100.34
                            </p>
                            <h5>
                                17th November
                            </h5>
                        </div>
                    </div>
                </div>
              </div>

              <div class="container3">
                <div class="top">
                    <h3>My Cards</h3>
                    <a href="">View all</a>
                </div>
                <div class="cards">
                    <div class="card1">
                       <div class="top">
                        <div class="logo"><img src="css/images/lemo logo.png" alt=""></div>
                       <a href="">. . .</a>
                       </div>

                       <div class="mid">
                        <p>CARD NUMBER</p>
                        <div class="value">
                            ..... 0352
                        </div>
                       </div>

                       <div class="bottom">
                        <p>EXPIRING</p>
                        <div class="value">
                            12/26
                        </div>
                       </div>

                        
                    </div>
                </div>
              </div>
        </section>

        <section class="third">
            <div class="savings">
                <h4>Start saving</h4>

                <div class="savings-section">
                    <div class="animated-background">
                      <div class="content">
                        <h3 class="headline">Start Saving for a Brighter Tomorrow!</h3>
                        <p class="tagline">Set goals, save effortlessly, and watch your wealth grow.</p>
                        <button class="cta">Start Saving Now</button>
                      </div>
                      <img src="./css/images/rb_13529.png" alt="Piggy Bank" class="animation">
                    </div>
                  </div>
                  
              </div>
        </section>
        
            <div class="news-section">
                
              </div>


              
              </div><br><br><br><br><br>

    </div>

    <!-- Deposit Overlay -->
    <div id="depositOverlay" class="overlay">
        <div class="overlay-content">
            <button id="closeOverlay" class="close-button">X</button>
            <h3>Deposit Options</h3>
            <div class="option" id="buyDollarOption">
                <h3>Fund Account with fiat money</h3>
                <p>USD</p>
            </div>
            <div class="option" id="depositCryptoOption">
                <h3>Deposit Crypto</h3>
                <p>Already have crypto? Deposit directly.</p>
            </div>
            <em>
                We recommend that you use a secure and reliable payment method to ensure a smooth transaction.
            </em>
        </div>
    </div>

    

    <div class="bottom-nav">
        <ul class="nav-links">
            <li><a href="main-page.html"><img src="./css/images/Control Panel.png" alt="Home Icon"><span>Home</span></a></li>
            <li><a href="chatbot.html"><img src="./css/images/Continuous Mode.png" alt="pages" ><span>Pages</span></a></li>
            <li><a href="wallet.html"><img src="./css/images/Bank Cards.png" alt="cards" ><span>Cards</span></a></li>
            <li><a href="settings.html"><img src="./css/images/Settings.png" alt="Settings" ><span>Settings</span></a></li>
            <li><a href="assets.html"><img src="./css/images/WeChat.png" alt="Chat"><span>Chat</span></a></li>
        </ul>
    </div>
<script src="java.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', async () => {
    const email = localStorage.getItem('username'); // Get email from localStorage

    if (!email) {
        alert('User not logged in');
        return;
    }

    try {
        // Make the GET request to the backend
        const response = await fetch(`/api/dashboard?email=${email}`, {
            method: 'GET',
            headers: { 'Content-Type': 'application/json' }
        });

        const data = await response.json();

        if (response.ok) {
            // Update dashboard with the fetched data
            document.getElementById('balance').textContent = `$ ${data.data.balance.toFixed(2)}`;
            document.getElementById('income').textContent = `$ ${data.data.income.toFixed(2)}`;
            document.getElementById('expenses').textContent = `$ ${data.data.expenses.toFixed(2)}`;
            document.getElementById('totalBills').textContent = `$ ${data.data.total_bills.toFixed(2)}`;
            document.getElementById('savings').textContent = `$ ${data.data.savings.toFixed(2)}`;
        } else {
            alert(data.message || 'Failed to fetch user details');
        }
    } catch (error) {
        console.error('Error fetching user details:', error);
        alert('An error occurred while fetching your data. Please try again later.');
    }
});





document.getElementById('depositButton').addEventListener('click', async () => {
    const email = localStorage.getItem('username');
    const depositAmount = prompt('Enter deposit amount:');
    
    if (!depositAmount || isNaN(depositAmount) || depositAmount <= 0) {
        alert('Invalid deposit amount');
        return;
    }

    try {
        // Update balance (this can be customized for other financial updates)
        const response = await fetch('/api/update-finances', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                email,
                balance: Number(depositAmount), // Update the balance (you can implement more logic here)
                income: 0, // Just as an example, you would need to customize based on your needs
                expenses: 0,
                total_bills: 0,
                savings: 0
            })
        });

        const data = await response.json();

        if (response.ok) {
            alert('Deposit successful!');
            window.location.reload(); // Reload to fetch updated data
        } else {
            alert(data.message || 'Failed to update balance');
        }
    } catch (error) {
        console.error('Error during deposit:', error);
        alert('An error occurred while updating your balance. Please try again later.');
    }
});


</script>
</body>
</html>